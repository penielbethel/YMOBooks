<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nigeria Tax Calculator - Calculate Your Income Tax</title>
    <meta name="description" content="Calculate your Nigerian personal income tax with accurate tax brackets and deductions for mortgage, pension, rent, and insurance.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        background: '#ffffff',
                        foreground: '#09090b',
                        card: '#ffffff',
                        'card-foreground': '#09090b',
                        popover: '#ffffff',
                        'popover-foreground': '#09090b',
                        primary: '#18181b',
                        'primary-foreground': '#fafafa',
                        secondary: '#f4f4f5',
                        'secondary-foreground': '#18181b',
                        muted: '#f4f4f5',
                        'muted-foreground': '#71717a',
                        accent: '#f4f4f5',
                        'accent-foreground': '#18181b',
                        destructive: '#ef4444',
                        'destructive-foreground': '#fafafa',
                        border: '#e4e4e7',
                        input: '#e4e4e7',
                        ring: '#18181b',
                        teal: {
                            500: '#14b8a6', // Tax Color match
                            600: '#0d9488',
                        },
                        orange: {
                            200: '#fed7aa', // Take Home Color match
                            300: '#fdba74',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom scrollbar to match clean look */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background-color: rgba(156, 163, 175, 0.5); border-radius: 20px; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-background via-background to-secondary/20 font-sans antialiased">

    <!-- Navigation Header (YMOBooks) -->
    <header class="bg-[#cc5500] text-white py-4 px-6 shadow-sm mb-8">
        <div class="max-w-7xl mx-auto flex items-center gap-3">
            <a href="index.html" class="flex items-center gap-3 hover:opacity-90 transition-opacity">
                <span class="font-bold text-xl tracking-wide">YMOBooks</span>
            </a>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 sm:py-12 md:py-16 lg:px-8 max-w-7xl">
        
        <!-- Title Section -->
        <div class="mb-12 text-center sm:mb-16">
            <h1 class="text-balance text-4xl font-bold tracking-tight text-foreground sm:text-5xl md:text-6xl lg:text-7xl">Nigeria Tax Calculator</h1>
            <p class="mx-auto mt-4 max-w-2xl text-pretty text-lg text-muted-foreground sm:mt-6 sm:text-xl md:text-2xl">
                Calculate your personal income tax based on Nigerian tax laws
            </p>
        </div>

        <!-- Info Card: How it works -->
        <div class="mb-8 sm:mb-10">
            <div class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 border-primary/20 shadow-sm">
                <div class="grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 pb-6 border-b border-border/50">
                    <div class="font-semibold flex items-center gap-2 text-xl md:text-2xl">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 text-primary md:h-6 md:w-6"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>
                        How This Calculator Works
                    </div>
                </div>
                <div class="px-6 space-y-4">
                    <div class="space-y-2">
                        <p class="text-pretty text-sm leading-relaxed text-foreground md:text-base">This calculator helps you understand how much tax you'll pay on your annual income in Nigeria. It automatically calculates your tax based on Nigerian tax laws and includes all the deductions you're entitled to.</p>
                        <p class="text-pretty text-sm leading-relaxed text-muted-foreground md:text-base">Simply enter your yearly salary or income, and we'll show you exactly how much tax you owe and how much money you'll take home after taxes. You can toggle between annual and monthly views to see your breakdown.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Understanding Tax Brackets (Collapsible) -->
        <div class="mb-8 sm:mb-10">
            <div class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm">
                <div class="px-6 pb-6 border-b border-border/50">
                    <button onclick="toggleBrackets()" class="flex w-full items-center justify-between text-left transition-colors hover:text-primary">
                        <div class="font-semibold flex items-center gap-2 text-lg md:text-xl">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 text-primary"><rect width="16" height="20" x="4" y="2" rx="2"></rect><line x1="8" x2="16" y1="6" y2="6"></line><line x1="16" x2="16" y1="14" y2="18"></line><path d="M16 10h.01"></path><path d="M12 10h.01"></path><path d="M8 10h.01"></path><path d="M12 14h.01"></path><path d="M8 14h.01"></path><path d="M12 18h.01"></path><path d="M8 18h.01"></path></svg>
                            Understanding Tax Brackets
                        </div>
                        <svg id="bracket-chevron" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 text-muted-foreground transition-transform duration-200"><path d="m6 9 6 6 6-6"></path></svg>
                    </button>
                </div>
                <div id="brackets-content" class="hidden px-6 space-y-4">
                    <div class="space-y-4">
                        <p class="text-sm text-muted-foreground">Nigeria uses a progressive tax system, which means the more you earn, the higher percentage you pay on the additional income. Here's how it works:</p>
                        <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
                            <div class="rounded-lg border p-4">
                                <div class="text-sm font-medium text-muted-foreground">First ₦800,000</div>
                                <div class="mt-1 text-2xl font-bold text-foreground">0%</div>
                                <div class="mt-1 text-xs text-muted-foreground">Tax free</div>
                            </div>
                            <div class="rounded-lg border p-4">
                                <div class="text-sm font-medium text-muted-foreground">Next ₦2.2 Million</div>
                                <div class="mt-1 text-2xl font-bold text-foreground">15%</div>
                                <div class="mt-1 text-xs text-muted-foreground">₦800,001 - ₦3,000,000</div>
                            </div>
                            <div class="rounded-lg border p-4">
                                <div class="text-sm font-medium text-muted-foreground">Next ₦9 Million</div>
                                <div class="mt-1 text-2xl font-bold text-foreground">18%</div>
                                <div class="mt-1 text-xs text-muted-foreground">₦3,000,001 - ₦12,000,000</div>
                            </div>
                            <div class="rounded-lg border p-4">
                                <div class="text-sm font-medium text-muted-foreground">Next ₦13 Million</div>
                                <div class="mt-1 text-2xl font-bold text-foreground">21%</div>
                                <div class="mt-1 text-xs text-muted-foreground">₦12,000,001 - ₦25,000,000</div>
                            </div>
                            <div class="rounded-lg border p-4">
                                <div class="text-sm font-medium text-muted-foreground">Next ₦25 Million</div>
                                <div class="mt-1 text-2xl font-bold text-foreground">23%</div>
                                <div class="mt-1 text-xs text-muted-foreground">₦25,000,001 - ₦50,000,000</div>
                            </div>
                            <div class="rounded-lg border p-4">
                                <div class="text-sm font-medium text-muted-foreground">Above ₦50 Million</div>
                                <div class="mt-1 text-2xl font-bold text-foreground">25%</div>
                                <div class="mt-1 text-xs text-muted-foreground">Anything above ₦50M</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="space-y-6">
            <div class="grid gap-6 lg:grid-cols-2 lg:gap-8">
                
                <!-- Input Section -->
                <div>
                    <div class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 border-border/50 shadow-lg backdrop-blur-sm">
                        <div class="px-6 pb-6 border-b border-border/50 space-y-2">
                            <div class="font-semibold flex items-center gap-2.5 text-2xl">
                                <div class="rounded-lg bg-primary/10 p-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 text-primary"><rect width="16" height="20" x="4" y="2" rx="2"></rect><line x1="8" x2="16" y1="6" y2="6"></line><line x1="16" x2="16" y1="14" y2="18"></line><path d="M16 10h.01"></path><path d="M12 10h.01"></path><path d="M8 10h.01"></path><path d="M12 14h.01"></path><path d="M8 14h.01"></path><path d="M12 18h.01"></path><path d="M8 18h.01"></path></svg>
                                </div>
                                Income & Deductions
                            </div>
                            <div class="text-muted-foreground text-base">Enter your gross income (before tax)</div>
                        </div>

                        <div class="px-6 space-y-6">
                            <!-- View Mode Toggle -->
                            <div class="space-y-3">
                                <label class="flex items-center gap-2 text-sm font-semibold uppercase tracking-wide text-muted-foreground">View Mode</label>
                                <div class="flex items-center gap-2 rounded-xl bg-muted/50 p-1.5">
                                    <button id="btn-annual" onclick="setMode(true)" class="flex flex-1 items-center justify-center gap-2 rounded-lg px-4 py-3 text-sm font-semibold transition-all bg-primary text-primary-foreground shadow-md">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg>
                                        Annual
                                    </button>
                                    <button id="btn-monthly" onclick="setMode(false)" class="flex flex-1 items-center justify-center gap-2 rounded-lg px-4 py-3 text-sm font-semibold transition-all text-muted-foreground hover:text-foreground">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg>
                                        Monthly
                                    </button>
                                </div>
                            </div>

                            <div class="h-px bg-border w-full my-6"></div>

                            <!-- Gross Income Input -->
                            <div class="space-y-3">
                                <label class="flex items-center gap-2 text-lg font-bold" for="gross-income">
                                    <span id="label-gross">Annual Gross Income</span>
                                </label>
                                <div class="relative">
                                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl font-bold text-muted-foreground">₦</span>
                                    <input id="gross-income" type="text" inputmode="numeric" placeholder="0" class="w-full min-w-0 rounded-md bg-transparent px-3 py-1 shadow-xs transition-all outline-none h-14 border-2 pl-10 text-xl font-bold border-input focus:border-primary focus:ring-4 focus:ring-primary/10" oninput="formatInput(this); calculate()">
                                </div>
                            </div>

                            <div class="h-px bg-border w-full my-6"></div>

                            <!-- Deductions -->
                            <div class="space-y-5">
                                <h3 class="text-base font-bold uppercase tracking-wide text-foreground">Deductions (Editable)</h3>
                                <div class="grid gap-4">
                                    
                                    <!-- Mortgage -->
                                    <div class="space-y-2 rounded-lg bg-muted/30 p-4">
                                        <div class="flex items-center justify-between">
                                            <label class="flex items-center gap-2 text-sm font-semibold" for="mortgage">Mortgage</label>
                                            <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-xs font-medium text-primary">10% default</span>
                                        </div>
                                        <div class="relative">
                                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-base font-semibold text-muted-foreground">₦</span>
                                            <input id="mortgage" type="text" inputmode="numeric" placeholder="0" class="w-full min-w-0 rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-xs transition-all outline-none h-11 pl-8 font-semibold focus:border-primary focus:ring-4 focus:ring-primary/10" oninput="formatInput(this); calculate()">
                                        </div>
                                    </div>

                                    <!-- Pension -->
                                    <div class="space-y-2 rounded-lg bg-muted/30 p-4">
                                        <div class="flex items-center justify-between">
                                            <label class="flex items-center gap-2 text-sm font-semibold" for="pension">Pension (Pencom)</label>
                                            <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-xs font-medium text-primary">8% default</span>
                                        </div>
                                        <div class="relative">
                                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-base font-semibold text-muted-foreground">₦</span>
                                            <input id="pension" type="text" inputmode="numeric" placeholder="0" class="w-full min-w-0 rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-xs transition-all outline-none h-11 pl-8 font-semibold focus:border-primary focus:ring-4 focus:ring-primary/10" oninput="formatInput(this); calculate()">
                                        </div>
                                    </div>

                                    <!-- Rent -->
                                    <div class="space-y-2 rounded-lg bg-muted/30 p-4">
                                        <div class="flex items-center justify-between">
                                            <label class="flex items-center gap-2 text-sm font-semibold" for="rent">Annual Rent</label>
                                            <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-xs font-medium text-primary">20% max ₦500k</span>
                                        </div>
                                        <div class="relative">
                                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-base font-semibold text-muted-foreground">₦</span>
                                            <input id="rent" type="text" inputmode="numeric" placeholder="0" class="w-full min-w-0 rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-xs transition-all outline-none h-11 pl-8 font-semibold focus:border-primary focus:ring-4 focus:ring-primary/10" oninput="formatInput(this); calculate()">
                                        </div>
                                    </div>

                                    <!-- Life Insurance -->
                                    <div class="space-y-2 rounded-lg bg-muted/30 p-4">
                                        <div class="flex items-center justify-between">
                                            <label class="flex items-center gap-2 text-sm font-semibold" for="insurance">Life Insurance</label>
                                            <span class="rounded-full bg-primary/10 px-2.5 py-0.5 text-xs font-medium text-primary">Default amount</span>
                                        </div>
                                        <div class="relative">
                                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-base font-semibold text-muted-foreground">₦</span>
                                            <input id="insurance" type="text" inputmode="numeric" placeholder="0" class="w-full min-w-0 rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-xs transition-all outline-none h-11 pl-8 font-semibold focus:border-primary focus:ring-4 focus:ring-primary/10" oninput="formatInput(this); calculate()">
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Section (Sticky) -->
                <div class="space-y-6">
                    <div class="lg:sticky lg:top-8">
                        <div class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 border-border/50 shadow-lg backdrop-blur-sm">
                            <div class="px-6 pb-6 border-b border-border/50 space-y-2">
                                <div class="font-semibold flex items-center gap-2.5 text-xl">
                                    <div class="rounded-lg bg-orange-200/50 p-1.5">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-orange-600"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                                    </div>
                                    Your Tax Calculation (<span id="res-view-label">Annual</span>)
                                </div>
                            </div>

                            <div class="px-6">
                                <!-- Initial Empty State -->
                                <div id="initial-state" class="py-12 text-center md:py-16">
                                    <div class="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-muted">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-8 w-8 text-muted-foreground"><rect width="16" height="20" x="4" y="2" rx="2"></rect><line x1="8" x2="16" y1="6" y2="6"></line><line x1="16" x2="16" y1="14" y2="18"></line><path d="M16 10h.01"></path><path d="M12 10h.01"></path><path d="M8 10h.01"></path><path d="M12 14h.01"></path><path d="M8 14h.01"></path><path d="M12 18h.01"></path><path d="M8 18h.01"></path></svg>
                                    </div>
                                    <p class="text-base font-medium text-muted-foreground">Enter your income to calculate tax</p>
                                </div>

                                <!-- Calculated Results State (Hidden by default) -->
                                <div id="calculated-state" class="hidden space-y-6">
                                    
                                    <!-- Context Header -->
                                    <div class="rounded-lg bg-[#e0f7fa] p-4 border border-cyan-100">
                                        <p class="text-sm text-gray-700 font-medium">Based on your <span id="ctx-view">annual</span> income of <span id="ctx-gross" class="font-bold text-gray-900">₦0</span>:</p>
                                    </div>

                                    <!-- Breakdown List -->
                                    <div class="space-y-4 text-sm sm:text-base">
                                        <!-- Gross Income -->
                                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                                            <span class="text-gray-500 font-medium">Gross Income:</span>
                                            <span id="res-gross" class="font-bold text-gray-900">₦0</span>
                                        </div>

                                        <!-- Deductions List -->
                                        <div class="space-y-2 py-2 border-b border-gray-100">
                                            <span class="text-gray-500 font-medium block mb-1">Deductions:</span>
                                            <div id="deductions-list" class="space-y-1 pl-4">
                                                <!-- Dynamic Content -->
                                            </div>
                                        </div>

                                        <!-- Taxable Income -->
                                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                                            <span class="text-gray-900 font-bold">Taxable Income:</span>
                                            <span id="res-taxable" class="font-bold text-gray-900">₦0</span>
                                        </div>

                                        <!-- Tax Calculation Breakdown -->
                                        <div class="space-y-2 py-2">
                                            <span class="text-xs text-gray-500 font-medium uppercase tracking-wide">Tax Calculation:</span>
                                            <div id="tax-breakdown-list" class="space-y-1 pl-0 text-gray-600 text-sm">
                                                <!-- Dynamic Content -->
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Total Tax -->
                                    <div class="rounded-xl bg-[#2a9d8f] text-white p-4 flex justify-between items-center shadow-md">
                                        <span class="font-bold">Total Tax:</span>
                                        <span id="res-tax" class="font-bold text-xl">₦0</span>
                                    </div>

                                    <!-- Take Home -->
                                    <div class="rounded-xl bg-[#f4a261] text-white p-4 flex justify-between items-center shadow-md">
                                        <span class="font-bold">Take-Home Income:</span>
                                        <span id="res-net" class="font-bold text-xl">₦0</span>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </main>

    <!-- Footer (Oduko style) -->
    <footer class="mt-12 border-t border-border/50 bg-background/50 py-6 pb-24 sm:mt-16 sm:py-8 sm:pb-28 md:mt-20 md:py-12 md:pb-32">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col items-center justify-center gap-6 text-center sm:flex-row sm:justify-between sm:gap-4">
                <div class="space-y-3 sm:space-y-2">
                    <p class="text-xs font-semibold text-foreground sm:text-sm">Contact Oduko</p>
                    <div class="flex flex-col items-center gap-3 sm:flex-row sm:gap-4">
                        <a href="mailto:odukoregistrydev@gmail.com" class="flex items-center gap-2 break-all text-xs text-muted-foreground transition-colors hover:text-foreground sm:text-sm sm:break-normal">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-3.5 w-3.5 flex-shrink-0 sm:h-4 sm:w-4"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
                            <span class="break-all sm:break-normal">odukoregistrydev@gmail.com</span>
                        </a>
                        <a href="tel:+2349011141113" class="flex items-center gap-2 text-xs text-muted-foreground transition-colors hover:text-foreground sm:text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-3.5 w-3.5 flex-shrink-0 sm:h-4 sm:w-4"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                            <span>(+234) 9011141113</span>
                        </a>
                    </div>
                </div>
                <div class="text-xs text-muted-foreground sm:text-sm">
                    <p class="break-words">© 2026 Oduko Tax Calculator. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let isAnnual = true;
        let hasInteracted = false;

        function formatMoney(amount) {
            return '₦' + amount.toFixed(0).replace(/\d(?=(\d{3})+$)/g, '$&,');
        }

        function formatInput(input) {
            let value = input.value.replace(/[^0-9.]/g, '');
            if (value) {
                const parts = value.split('.');
                if (parts.length > 2) {
                    value = parts[0] + '.' + parts.slice(1).join('');
                }
                const integerPart = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                input.value = parts.length > 1 ? integerPart + '.' + parts[1] : integerPart;
            } else {
                input.value = '';
            }
        }

        function getVal(id) {
            const val = document.getElementById(id).value.replace(/,/g, '');
            return parseFloat(val) || 0;
        }

        function toggleBrackets() {
            const content = document.getElementById('brackets-content');
            const chevron = document.getElementById('bracket-chevron');
            content.classList.toggle('hidden');
            if (content.classList.contains('hidden')) {
                chevron.style.transform = 'rotate(0deg)';
            } else {
                chevron.style.transform = 'rotate(180deg)';
            }
        }

        function setMode(annual) {
            isAnnual = annual;
            const btnAnnual = document.getElementById('btn-annual');
            const btnMonthly = document.getElementById('btn-monthly');
            const labelGross = document.getElementById('label-gross');
            
            // Labels updates
            document.getElementById('res-view-label').textContent = annual ? 'Annual' : 'Monthly';
            document.getElementById('ctx-view').textContent = annual ? 'annual' : 'monthly';

            if (annual) {
                btnAnnual.classList.remove('bg-muted/50', 'text-muted-foreground');
                btnAnnual.classList.add('bg-primary', 'text-primary-foreground', 'shadow-md');
                btnMonthly.classList.remove('bg-primary', 'text-primary-foreground', 'shadow-md');
                btnMonthly.classList.add('text-muted-foreground', 'hover:text-foreground');
                labelGross.textContent = 'Annual Gross Income';
            } else {
                btnMonthly.classList.remove('bg-muted/50', 'text-muted-foreground');
                btnMonthly.classList.add('bg-primary', 'text-primary-foreground', 'shadow-md');
                btnAnnual.classList.remove('bg-primary', 'text-primary-foreground', 'shadow-md');
                btnAnnual.classList.add('text-muted-foreground', 'hover:text-foreground');
                labelGross.textContent = 'Monthly Gross Income';
            }
            calculate();
        }

        function calculate() {
            const grossInput = document.getElementById('gross-income').value;
            
            if (!grossInput && !hasInteracted) {
                document.getElementById('initial-state').classList.remove('hidden');
                document.getElementById('calculated-state').classList.add('hidden');
                return;
            }
            
            hasInteracted = true;
            document.getElementById('initial-state').classList.add('hidden');
            document.getElementById('calculated-state').classList.remove('hidden');

            let gross = getVal('gross-income');
            let mortgage = getVal('mortgage');
            let pension = getVal('pension');
            let rent = getVal('rent');
            let insurance = getVal('insurance');

            // If monthly, we convert to annual for tax calculation logic then convert back
            // OR we can just use monthly bands. 
            // The logic: 
            // 1. Convert Input to Annual (if monthly)
            // 2. Calculate Annual Tax
            // 3. Divide by 12 for Monthly Result
            
            let annualGross = gross;
            if (!isAnnual) {
                annualGross = gross * 12;
            }

            // --- Deductions Display Only ---
            // We calculate what they WOULD be (annualized or monthly as needed)
            // But we DO NOT subtract them from Taxable.
            
            // Populate Deductions List
            const deductionsList = document.getElementById('deductions-list');
            deductionsList.innerHTML = '';
            
            const addDedItem = (label, val) => {
                if (val > 0) {
                    const d = document.createElement('div');
                    d.className = 'flex justify-between items-center text-sm text-gray-500';
                    d.innerHTML = `<span>${label}:</span><span>- ${formatMoney(val)}</span>`;
                    deductionsList.appendChild(d);
                }
            };

            addDedItem('Pension (8%)', pension);
            addDedItem('Mortgage (10%)', mortgage);
            addDedItem('Rent', rent);
            addDedItem('Insurance', insurance);
            
            if (deductionsList.children.length === 0) {
                 deductionsList.innerHTML = '<span class="text-xs text-gray-400 italic">No deductions entered</span>';
            }


            // --- Tax Logic (Based on Control: Taxable = Gross) ---
            let taxable = annualGross;
            
            // Tax Bands (Annual)
            let tax = 0;
            let tempTaxable = taxable;
            const breakdown = [];

            // Band 1: First 800k @ 0%
            const b1 = 800000;
            let amt1 = Math.min(tempTaxable, b1);
            if (amt1 > 0) {
                breakdown.push({ limit: b1, rate: 0, tax: 0, amt: amt1 });
                tempTaxable -= amt1;
            }

            // Band 2: Next 2.2M (up to 3M) @ 15%
            const b2 = 3000000 - 800000;
            if (tempTaxable > 0) {
                let amt2 = Math.min(tempTaxable, b2);
                let t2 = amt2 * 0.15;
                tax += t2;
                breakdown.push({ limit: b2, rate: 15, tax: t2, amt: amt2 });
                tempTaxable -= amt2;
            }

            // Band 3: Next 9M (up to 12M) @ 18%
            const b3 = 12000000 - 3000000;
            if (tempTaxable > 0) {
                let amt3 = Math.min(tempTaxable, b3);
                let t3 = amt3 * 0.18;
                tax += t3;
                breakdown.push({ limit: b3, rate: 18, tax: t3, amt: amt3 });
                tempTaxable -= amt3;
            }

            // Band 4: Next 13M (up to 25M) @ 21%
            const b4 = 25000000 - 12000000;
            if (tempTaxable > 0) {
                let amt4 = Math.min(tempTaxable, b4);
                let t4 = amt4 * 0.21;
                tax += t4;
                breakdown.push({ limit: b4, rate: 21, tax: t4, amt: amt4 });
                tempTaxable -= amt4;
            }

            // Band 5: Next 25M (up to 50M) @ 23%
            const b5 = 50000000 - 25000000;
            if (tempTaxable > 0) {
                let amt5 = Math.min(tempTaxable, b5);
                let t5 = amt5 * 0.23;
                tax += t5;
                breakdown.push({ limit: b5, rate: 23, tax: t5, amt: amt5 });
                tempTaxable -= amt5;
            }

            // Band 6: Above 50M @ 25%
            if (tempTaxable > 0) {
                let t6 = tempTaxable * 0.25;
                tax += t6;
                breakdown.push({ limit: -1, rate: 25, tax: t6, amt: tempTaxable });
            }

            const net = annualGross - tax;

            // --- Display Results ---
            const divisor = isAnnual ? 1 : 12;

            document.getElementById('ctx-gross').textContent = formatMoney(gross);
            document.getElementById('res-gross').textContent = formatMoney(annualGross / divisor);
            document.getElementById('res-taxable').textContent = formatMoney(taxable / divisor);
            document.getElementById('res-tax').textContent = formatMoney(tax / divisor);
            document.getElementById('res-net').textContent = formatMoney(net / divisor);

            // Populate Tax Breakdown List
            const taxList = document.getElementById('tax-breakdown-list');
            taxList.innerHTML = '';
            
            // "First ₦800,000 at 0% = ₦0"
            // "Next ₦133,333 at 15% = ₦20,000"
            breakdown.forEach(b => {
                const amt = b.amt / divisor;
                const tx = b.tax / divisor;
                const label = b.limit === -1 ? `Balance` : (b.rate === 0 ? `First` : `Next`);
                
                // If it's the First band (0%), logic is usually "First X at 0% = NO" or "₦0"
                const taxStr = b.rate === 0 ? 'NO' : formatMoney(tx);
                
                const div = document.createElement('div');
                div.textContent = `${label} ${formatMoney(amt)} at ${b.rate}% = ${taxStr}`;
                taxList.appendChild(div);
            });
        }
    </script>
</body>
</html>
